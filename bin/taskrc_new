#!/bin/bash
# taskrc_new: create a new taskrc in $taskrc_dir using template content


taskrc_dir=${taskrc_dir:-$PWD}

function plain_new {
    cat << EOF
# taskrc for $(basename $PWD)
# vim: filetype=sh :

# If someone does a raw "source taskrc", we ensure that \$taskrc_dir gets defined anyway
[[ -z \$taskrc_dir && -f taskrc ]] && export taskrc_dir=\$PWD

#type -t localhist_set >/dev/null && { localhist_set \${taskrc_dir}/bash_history;  echo "HISTFILE is \$HISTFILE"; }

# Use taskrc -h for help on built-in taskrc functions.
# To provide help for definitions in this file, add #Help tags, e.g.:
# function my_func {
    #Help: my_func is my first and only function...
# }
EOF

}

function markdown_new {

    cat << EOF2
## taskrc.md for $(basename $PWD)

\`\`\`bash
$(plain_new)
\`\`\`
EOF2

}


if [[ -z $sourceMe ]]; then
    cd ${taskrc_dir} || errExit "Can't cd to $taskrc_dir"
    if [[ $1 == "--cat" ]]; then
        plain_new
        exit 0
    fi
    plain_new > taskrc
    echo "New taskrc created in $PWD: OK" >&2
fi
true

